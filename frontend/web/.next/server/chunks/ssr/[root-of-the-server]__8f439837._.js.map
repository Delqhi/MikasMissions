{"version":3,"sources":["../../../../app/kids/core/page.tsx"],"sourcesContent":["import { KidsShell } from \"../../../components/layout/kids_shell\";\nimport { SectionHeading } from \"../../../components/ui/section_heading\";\nimport { StoryCard } from \"../../../components/ui/story_card\";\nimport { EpisodeTile } from \"../../../components/ui/episode_tile\";\nimport { ParentGatePrompt } from \"../../../components/ui/parent_gate_prompt\";\nimport { fetchKidsHome } from \"../../../lib/fetch_kids_home\";\nimport { fetchKidsProgress } from \"../../../lib/fetch_kids_progress\";\nimport { accessTokenFromCookie } from \"../../../lib/server_auth\";\nimport styles from \"../kids_page.module.css\";\n\nexport const dynamic = \"force-dynamic\";\n\ntype KidsPageProps = {\n  searchParams: Promise<Record<string, string | string[] | undefined>>;\n};\n\nexport default async function KidsCorePage({ searchParams }: KidsPageProps) {\n  const params = await searchParams;\n  const childProfileID = typeof params.child_profile_id === \"string\" ? params.child_profile_id : \"\";\n  if (childProfileID === \"\") {\n    return (\n      <KidsShell\n        activeNav=\"Home\"\n        ageBand=\"6-11\"\n        mode=\"core\"\n        navItems={[\n          { label: \"Home\", href: \"/kids/core#featured\" },\n          { label: \"Missions\", href: \"/kids/core#missions\" },\n          { label: \"Discover\", href: \"/kids/core#picks\" },\n          { label: \"Progress\", href: \"/kids/core#status\" },\n          { label: \"Library\", href: \"/parents/onboarding\" }\n        ]}\n        profileName=\"Setup required\"\n        sessionLimitMinutes={0}\n        subtitle=\"Please create a child profile first\"\n        watchedMinutes={0}\n      >\n        <div className=\"stack\">\n          <section className={styles.focusCard}>\n            <h3>Missing child profile</h3>\n            <p>Open parent onboarding and create a profile to continue.</p>\n            <a href=\"/parents/onboarding\">Go to onboarding</a>\n          </section>\n        </div>\n      </KidsShell>\n    );\n  }\n  const token = await accessTokenFromCookie();\n  const [home, progress] = await Promise.all([\n    fetchKidsHome(\"core\", childProfileID, token),\n    fetchKidsProgress(\"core\", childProfileID, token)\n  ]);\n  const featured = home.rails[0];\n  const featuredItems = home.rails.slice(0, 2);\n\n  return (\n    <KidsShell\n      activeNav=\"Home\"\n      ageBand=\"6-11\"\n      mode=\"core\"\n      navItems={[\n        { label: \"Home\", href: `/kids/core?child_profile_id=${encodeURIComponent(childProfileID)}#featured` },\n        { label: \"Missions\", href: `/kids/core?child_profile_id=${encodeURIComponent(childProfileID)}#missions` },\n        { label: \"Discover\", href: `/kids/core?child_profile_id=${encodeURIComponent(childProfileID)}#picks` },\n        { label: \"Progress\", href: `/kids/core?child_profile_id=${encodeURIComponent(childProfileID)}#status` },\n        { label: \"Library\", href: `/parents?child_profile_id=${encodeURIComponent(childProfileID)}` }\n      ]}\n      profileName=\"Mika Explorer\"\n      sessionLimitMinutes={progress.session_limit_minutes}\n      subtitle=\"Curated search and learning rails\"\n      watchedMinutes={progress.watched_minutes_today}\n    >\n      <div className=\"stack\">\n        <nav className={styles.switchRow}>\n          <a href={`/kids/early?child_profile_id=${encodeURIComponent(childProfileID)}`}>3-5</a>\n          <a aria-current=\"page\" href={`/kids/core?child_profile_id=${encodeURIComponent(childProfileID)}`}>\n            6-11\n          </a>\n          <a href={`/kids/teen?child_profile_id=${encodeURIComponent(childProfileID)}`}>12-16</a>\n          <a href={`/parents?child_profile_id=${encodeURIComponent(childProfileID)}`}>Parents</a>\n        </nav>\n\n        <section className={styles.heroPanel} id=\"featured\">\n          <img alt=\"\" src={featured.thumbnail_url} />\n          <div className={styles.heroShade} />\n          <div className={styles.heroBody}>\n            <span className={styles.heroKicker}>Core featured</span>\n            <h2>{featured.title}</h2>\n            <p>{featured.summary}</p>\n            <div className={styles.heroActions}>\n              <a className={styles.heroPlay} href={`/kids/core?child_profile_id=${encodeURIComponent(childProfileID)}`}>\n                Play episode\n              </a>\n              <a className={styles.heroInfo} href={`/parents?child_profile_id=${encodeURIComponent(childProfileID)}`}>\n                Parent controls\n              </a>\n            </div>\n            <ul className={styles.heroMeta}>\n              <li>{progress.completion_percent}% completed</li>\n              <li>{progress.watched_minutes_today} min watched today</li>\n              <li>Safety filters active</li>\n            </ul>\n          </div>\n        </section>\n\n        <section className=\"railSection\" id=\"missions\">\n          <SectionHeading\n            description=\"Mission progression is visible, motivating, and free from streak pressure mechanics.\"\n            title=\"Continue your learning path\"\n          />\n          <div className={styles.storyRow}>\n            {featuredItems.map((item, index) => (\n              <StoryCard index={index} item={item} key={item.episode_id} />\n            ))}\n          </div>\n        </section>\n\n        <section className=\"railSection\" id=\"picks\">\n          <SectionHeading\n            description=\"Exploration remains bounded through safe rails, quality labels, and age-fit scores.\"\n            title=\"Explore safely\"\n          />\n          <div className={styles.tileRow}>\n            {home.rails.map((item) => (\n              <EpisodeTile episode={item} key={item.episode_id} />\n            ))}\n          </div>\n        </section>\n\n        <section className={styles.calloutGrid} id=\"status\">\n          <article className={styles.focusCard}>\n            <h3>Curated search only</h3>\n            <p>Children navigate by pre-defined themes instead of unrestricted text search.</p>\n          </article>\n          <article className={styles.focusCard}>\n            <h3>Progress clarity</h3>\n            <p>{progress.completion_percent}% mission completion today with transparent milestones.</p>\n          </article>\n          <ParentGatePrompt actionLabel=\"Share to external platform\" challengeType=\"pin\" />\n        </section>\n      </div>\n    </KidsShell>\n  );\n}\n"],"names":[],"mappings":"2YAAA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,MAQe,eAAe,EAAa,cAAE,CAAY,CAAiB,EACxE,IAAM,EAAS,MAAM,EACf,EAAiB,AAAmC,iBAA5B,EAAO,gBAAgB,CAAgB,EAAO,gBAAgB,CAAG,GAC/F,GAAuB,IAAI,CAAvB,EACF,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,UAAU,OACV,QAAQ,OACR,KAAK,OACL,SAAU,CACR,CAAE,MAAO,OAAQ,KAAM,qBAAsB,EAC7C,CAAE,MAAO,WAAY,KAAM,qBAAsB,EACjD,CAAE,MAAO,WAAY,KAAM,kBAAmB,EAC9C,CAAE,MAAO,WAAY,KAAM,mBAAoB,EAC/C,CAAE,MAAO,UAAW,KAAM,qBAAsB,EACjD,CACD,YAAY,iBACZ,oBAAqB,EACrB,SAAS,sCACT,eAAgB,WAEhB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAW,EAAA,OAAM,CAAC,SAAS,WAClC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,0BACJ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,6DACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAK,+BAAsB,4BAMxC,IAAM,EAAQ,MAAM,CAAA,EAAA,EAAA,qBAAA,AAAqB,IACnC,CAAC,EAAM,EAAS,CAAG,MAAM,QAAQ,GAAG,CAAC,CACzC,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,OAAQ,EAAgB,GACtC,CAAA,EAAA,EAAA,iBAAA,AAAiB,EAAC,OAAQ,EAAgB,GAC3C,EACK,EAAW,EAAK,KAAK,CAAC,EAAE,CACxB,EAAgB,EAAK,KAAK,CAAC,KAAK,CAAC,EAAG,GAE1C,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,UAAU,OACV,QAAQ,OACR,KAAK,OACL,SAAU,CACR,CAAE,MAAO,OAAQ,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAgB,SAAS,CAAC,AAAC,EACpG,CAAE,MAAO,WAAY,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAgB,SAAS,CAAE,AAAD,EACvG,CAAE,MAAO,WAAY,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAgB,MAAM,CAAC,AAAC,EACrG,CAAE,MAAO,WAAY,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAgB,OAAO,CAAC,AAAC,EACtG,CAAE,MAAO,UAAW,KAAM,CAAC,0BAA0B,EAAE,mBAAmB,GAAA,CAAkB,AAAD,EAC5F,CACD,YAAY,gBACZ,oBAAqB,EAAS,qBAAqB,CACnD,SAAS,oCACT,eAAgB,EAAS,qBAAqB,UAE9C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,SAAS,WAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAM,CAAC,6BAA6B,EAAE,mBAAmB,GAAA,CAAiB,UAAE,QAC/E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,eAAa,OAAO,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAA,CAAiB,UAAE,SAGlG,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAA,CAAiB,UAAE,UAC9E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAM,CAAC,0BAA0B,EAAE,mBAAmB,GAAA,CAAiB,UAAE,eAG9E,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAW,EAAA,OAAM,CAAC,SAAS,CAAE,GAAG,qBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAI,GAAG,IAAK,EAAS,aAAa,GACvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,SAAS,GAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,UAAU,UAAE,kBACpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAI,EAAS,KAAK,GACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAG,EAAS,OAAO,GACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAChC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,EAAA,OAAM,CAAC,QAAQ,CAAE,KAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAA,CAAiB,UAAE,iBAG1G,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,EAAA,OAAM,CAAC,QAAQ,CAAE,KAAM,CAAC,0BAA0B,EAAE,mBAAmB,GAAA,CAAiB,UAAE,uBAI1G,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WAAI,EAAS,kBAAkB,CAAC,iBACjC,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WAAI,EAAS,qBAAqB,CAAC,wBACpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,mCAKV,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,cAAc,GAAG,qBAClC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CACb,YAAY,uFACZ,MAAM,gCAER,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC5B,EAAc,GAAG,CAAC,CAAC,EAAM,IACxB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,MAAO,EAAO,KAAM,GAAW,EAAK,UAAU,QAK/D,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,cAAc,GAAG,kBAClC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CACb,YAAY,sFACZ,MAAM,mBAER,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,OAAO,UAC3B,EAAK,KAAK,CAAC,GAAG,CAAE,AAAD,GACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,QAAS,GAAW,EAAK,UAAU,QAKtD,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAW,EAAA,OAAM,CAAC,WAAW,CAAE,GAAG,mBACzC,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAW,EAAA,OAAM,CAAC,SAAS,WAClC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,wBACJ,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,oFAEL,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAW,EAAA,OAAM,CAAC,SAAS,WAClC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,qBACJ,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WAAG,EAAS,kBAAkB,CAAC,gEAElC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,gBAAgB,CAAA,CAAC,YAAY,6BAA6B,cAAc,eAKnF,kCArIuB"}